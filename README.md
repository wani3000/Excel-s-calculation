# 투코내코 통합 서비스

두 개의 Excel 파일을 업로드하여 주문 전체내역과 매물코칭 DB를 비교하고, 투코내코 형식의 통합 결과를 생성하는 웹 서비스입니다.

## 주요 기능

- 📊 **Excel 파일 업로드**: 주문 전체내역(.xlsx)과 매물코칭 DB(.xlsx) 파일 업로드
- 🔍 **자동 비교**: **이름 + 닉네임**을 기준으로 자동 비교
- 📈 **결과 분류**: 
  - ✅ **매칭된 코칭 정보**: 결제완료 + 코칭등록이 모두 완료된 사람들
  - ❌ **결제했지만 DB 없음**: 결제했지만 코칭 DB에 등록되지 않은 사람들
  - ➕ **신청했지만 결제 없음**: 코칭 신청했지만 결제하지 않은 사람들
- 📥 **투코내코 Excel 다운로드**: 통합된 투코내코 시트 + 중복값만 시트로 분리
- 🎯 **투코내코 형식**: 결제 정보와 코칭 정보가 통합된 표준 형식으로 표시
- 🔍 **3단계 탭 구조**: 
  - 투코내코 통합결과 (메인)
  - 매칭된 데이터 (상세)
  - 불일치 데이터 (누락/결제안함)

## 기술 스택

- **Frontend**: React 18 + TypeScript
- **UI**: Tailwind CSS + Lucide React Icons
- **Excel 처리**: SheetJS (xlsx)
- **빌드 도구**: Vite

## 설치 및 실행

### 1. 의존성 설치

```bash
npm install
```

### 2. 개발 서버 실행

```bash
npm run dev
```

브라우저에서 `http://localhost:3000`으로 접속

### 3. 빌드

```bash
npm run build
```

## 사용 방법

### 1. 파일 업로드
- **주문 전체내역**: 결제자 목록이 포함된 Excel 파일
- **매물코칭 DB**: 신청자 목록이 포함된 Excel 파일

### 2. 시트 선택
- 업로드된 파일의 시트 목록에서 비교할 시트를 선택

### 3. 비교 실행
- "비교 실행" 버튼을 클릭하여 데이터 비교 수행

### 4. 결과 확인
- 웹 표에서 비교 결과 확인
- 필터를 사용하여 특정 결과만 표시
- 정렬 기능으로 데이터 정리

### 5. 결과 다운로드
- "Excel 다운로드" 버튼으로 결과 파일 다운로드
- 3개 시트로 분리: matched, only_in_a, only_in_b

## 데이터 형식 요구사항

### 주문 전체내역 파일
필수 컬럼:
- `주문번호`: 고유 식별자
- `닉네임`: 비교 키
- `이름`: 비교 키  
- `휴대폰번호`: 비교 키

### 매물코칭 DB 파일
필수 컬럼:
- `닉네임`: 비교 키
- `이름`: 비교 키
- `번호`: 비교 키 (휴대폰번호)

## 비교 로직

1. **키 생성**: `이름|닉네임` 형태로 고유 키 생성
2. **대소문자 무시**: 문자열 비교 시 대소문자 무시
3. **중복 처리**: 동일 키가 여러 개 있을 경우 첫 번째만 매칭
4. **통합 표시**: 매칭된 데이터는 결제 정보와 코칭 정보를 통합해서 표시

## 투코내코 결과 파일 구조

다운로드되는 Excel 파일은 2개 시트로 구성:

### 투코내코 시트 (메인)
투코내코 표준 형식의 통합 데이터:
- **전시상품명**: 투자코칭_25년 8월
- **기본정보**: 이름, 휴대폰번호, 주문번호, ID, 닉네임
- **상품정보**: 옵션정보
- **금액정보**: 판매액원, PG결제액원, 인앱결제액원, 포인트사용, 베네피아포인트, 상품권사용, 쿠폰할인
- **결제정보**: 상태, 결제일시, 대기신청일, 결제수단, 결제요청, 결제플랫폼
- **마케팅정보**: 마케팅수신동의, 예전아이디
- **코칭정보**: 담당코치, 코칭일정, 코칭신청일

### 중복값만 시트
매칭되지 않은 데이터만 별도 관리:
- 결제했지만 코칭 DB에 없는 사람들
- 코칭 신청했지만 결제하지 않은 사람들

## 브라우저 지원

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 라이선스

MIT License

## 투코내코 통합 서비스 특징

- **표준화된 형식**: 투코내코 표준 컬럼 구조에 맞춰 데이터 정제
- **자동 매핑**: 다양한 컬럼명을 투코내코 형식으로 자동 변환
- **통합 관리**: 결제 정보와 코칭 정보를 하나의 시트로 통합
- **누락 방지**: 불일치 데이터를 별도 시트로 분리하여 관리

## 개발자 정보

투코내코 통합 서비스 v2.0
